{% extends "base.html" %}
{% block title %}Change Password{% endblock %}

{% block content %}
<div class="container-fluid p-0">
  <div class="row g-0">
    <!-- Left Sidebar -->
    <div class="col-md-3 col-lg-2">
      <div class="sidebar" style="min-height: 100vh; background: linear-gradient(180deg, #2c3e50 0%, #1a2634 100%);">
        <!-- User Profile -->
        <div class="text-center py-5 px-3">
          <div class="avatar-circle mx-auto mb-3">
            <span class="avatar-initials">{{ current_user.username[0] | upper }}</span>
          </div>
          <h5 class="text-white mb-0">{{ current_user.username }}</h5>
        </div>

        <!-- Navigation -->
        <nav class="px-3">
          <a href="{{ url_for('dashboard') }}" class="nav-link d-flex align-items-center py-3 px-3 mb-2">
            <i class="fas fa-home me-3"></i><span>Dashboard</span>
          </a>
          <a href="{{ url_for('upload') }}" class="nav-link d-flex align-items-center py-3 px-3 mb-2">
            <i class="fas fa-upload me-3"></i><span>Upload File</span>
          </a>
          <a href="{{ url_for('view_details') }}" class="nav-link d-flex align-items-center py-3 px-3 mb-2">
            <i class="fas fa-user me-3"></i><span>Profile</span>
          </a>
          <a href="{{ url_for('files') }}" class="nav-link d-flex align-items-center py-3 px-3 mb-2">
            <i class="fas fa-folder-open me-3"></i><span>File Details</span>
          </a>
          <a href="{{ url_for('change_password') }}" class="nav-link d-flex align-items-center py-3 px-3 mb-2 active">
            <i class="fas fa-key me-3"></i><span>Change Password</span>
          </a>
          <a href="{{ url_for('logout') }}" class="nav-link d-flex align-items-center py-3 px-3 text-danger">
            <i class="fas fa-sign-out-alt me-3"></i><span>Logout</span>
          </a>
        </nav>
      </div>
    </div>

    <!-- Main Content -->
    <div class="col-md-9 col-lg-10 bg-light">
      <div class="p-4 d-flex align-items-center" style="min-height: 100vh;">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-md-6">
              <div class="card border-0 shadow">
                <div class="card-body p-4">
                  <h4 class="text-center mb-4">Change Password</h4>
                  
                  {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                      {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                      {% endfor %}
                    {% endif %}
                  {% endwith %}

                  <form method="POST">
                    <div class="mb-3">
                      <label class="form-label">Current Password</label>
                      <input type="password" name="current_password" class="form-control" minlength="8" maxlength="8" required>
                    </div>

                    <div class="mb-3">
                      <label class="form-label">New Password </label>
                      <input type="password" name="new_password" class="form-control" minlength="8" maxlength="8" required>
                    </div>

                    <div class="mb-4">
                      <label class="form-label">Confirm New Password</label>
                      <input type="password" name="confirm_password" class="form-control" minlength="8" maxlength="8" required>
                    </div>

                    <div class="d-grid gap-2">
                      <button type="submit" class="btn btn-primary">Update Password</button>
                      <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary">Cancel</a>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.sidebar {
  box-shadow: 2px 0 10px rgba(0,0,0,0.1);
}
.avatar-circle {
  width: 70px;
  height: 70px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid rgba(255,255,255,0.2);
}
.avatar-initials {
  font-size: 28px;
  color: white;
}
.nav-link {
  color: rgba(255,255,255,0.8);
  border-radius: 8px;
  transition: 0.3s;
  text-decoration: none;
}
.nav-link:hover {
  color: white;
  background: rgba(255,255,255,0.1);
}
.nav-link.active {
  color: white;
  background: rgba(255,255,255,0.15);
  border-left: 3px solid #f1c40f;
}
.form-control {
  border-radius: 8px;
  padding: 10px;
}
.btn {
  border-radius: 8px;
  padding: 10px;
}
</style>
{% endblock %}